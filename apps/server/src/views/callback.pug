doctype html
html(lang="en")
  head
    title NotionRetro
    meta(charset="utf-8")
    meta(name="viewport" content="width=device-width, initial-scale=1")
    link(rel="stylesheet" href="/css/tailwind.css")
  body.bg-gray-50.min-h-screen
    div
      h1 Notion Integration
      p
        if status === "success"
          | Success! You can close this window.
        else if status === "error"
          | Error: #{message}. Please try again.
        else
          | Processing...
  script.
    document.addEventListener("DOMContentLoaded", () => {
      const data = !{JSON.stringify(data || null)};
      const origin = "!{targetUrl}";

      if (window.opener) {
        if (window.opener.postMessage) {
          window.opener.postMessage(
            { type: "NOTION_CONNECTED", data },
            origin,
          );
          window.close();
        }
      }
    });
